@if (error) {
    <app-error [httpErrorResponse]="error"></app-error>
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <p>Welcome! On this website we try to show you public transport data in a simple straight forward way.</p>
            <p>
                Currently this is very much a work in progress, we do import data daily but we are still working on
                things. You may see for example some stops appearing twice and missing some data. Realtime data and data latency is also a work in progress.
            </p>
        </div>
        <div class="col-6">
            <div
                (window:resize)="onResize($event)"
                class="leaflet stop-map-view"
                leaflet
                [leafletOptions]="options"
                [leafletLayers]="layers"
                [leafletLayersControl]="layersControl"
                (leafletMapReady)="onMapReady($event)"
            ></div>
            <small>Your rough position is sent towards the API and checked against the database</small><br />
            <button
                type="button"
                class="btn btn-info"
                (click)="getNearbyStops()"
            >
                Search for nearby stops based on your location?
            </button>
            <!-- <button
                type="button"
                class="btn btn-info"
                (click)="getAllStops()"
            >
                Search for ALL stops?
            </button> -->
            @if (location) {
                <p>Got your location: {{ location.lat }} - {{ location.lng }}</p>
            }
        </div>

        <div class="col-lg-6 col-6">
            <form class="form-inline my-2 my-lg-0">
                <p><b>For which station do you want to see departures?</b></p>
                <small
                    >A part of west europe is in here (Mostly NL, BE, Berlin and Paris. Parts of the data of FR and DE),
                    flixbus and BlaBlaCar Bus</small
                >
                <br />
                <small>A good part of New Zealand</small><br />
                <small>Los Angeles Metro area</small><br />
                <small
                    >Fill in a stop you know nearby and let's see if we can find it. From there you can keep clicking
                    and see where you end up</small
                >

                <input
                    class="form-control mr-sm-2"
                    type="search"
                    placeholder="Amsterdam Centraal"
                    aria-label="Search"
                    [value]="originStop?.name"
                    (input)="onSearchInputChangeOrigin($event)"
                />
                @if (loading) {
                    <div>
                        <div
                            class="spinner-border"
                            role="status"
                        >
                            ðŸš‰
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p>Loading all stops...</p>
                    </div>
                }
                <div>
                    <div class="dropdown">
                        @for (stop of foundStopsOrigin; track stop) {
                            <a routerLink="/stops/{{ stop.id }}/{{ stop.stopType }}">
                                <button
                                    type="button"
                                    class="dropdown-item"
                                >
                                    <app-stop [stop]="stop"></app-stop></button
                            ></a>
                        } @empty {
                            @if (foundStopsOrigin !== undefined && !loading) {
                                <p>No relevant stops found</p>
                            }
                        }
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
